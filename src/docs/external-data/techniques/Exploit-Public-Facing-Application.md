
# Exploit Public-Facing Application

## Description

### MITRE Description

> The use of software, data, or commands to take advantage of a weakness in an Internet-facing computer system or program in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211).

If an application is hosted on cloud-based infrastructure, then exploiting it may lead to compromise of the underlying instance. This can allow an adversary a path to access the cloud APIs or to take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)

## Aliases

```

```

## Additional Attributes

* Bypass: None
* Effective Permissions: None
* Network: None
* Permissions: None
* Platforms: ['Linux', 'Windows', 'macOS', 'AWS', 'GCP', 'Azure']
* Remote: None
* Type: attack-pattern
* Wiki: https://attack.mitre.org/techniques/T1190

## Potential Commands

```
powershell/lateral_movement/jenkins_script_console
powershell/lateral_movement/jenkins_script_console
python/exploit/web/jboss_jmx
python/exploit/web/jboss_jmx
```

## Commands Dataset

```
[{'command': 'powershell/lateral_movement/jenkins_script_console',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/lateral_movement/jenkins_script_console',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'python/exploit/web/jboss_jmx',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'python/exploit/web/jboss_jmx',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'}]
```

## Potential Detections

```json
[{'data_source': {'author': 'Florian Roth',
                  'date': '2018/07/22',
                  'description': 'Detects access to a webshell droped into a '
                                 'keytore folder on the WebLogic server',
                  'detection': {'condition': 'selection',
                                'selection': {'c-uri-path': ['*/config/keystore/*.js*']}},
                  'falsepositives': ['Unknown'],
                  'fields': ['c-ip', 'c-dns'],
                  'id': '37e8369b-43bb-4bf8-83b6-6dd43bda2000',
                  'level': 'critical',
                  'logsource': {'category': 'webserver'},
                  'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894',
                                 'https://twitter.com/pyn3rd/status/1020620932967223296',
                                 'https://github.com/LandGrey/CVE-2018-2894'],
                  'status': 'experimental',
                  'tags': ['attack.t1100',
                           'attack.t1190',
                           'attack.initial_access',
                           'attack.persistence',
                           'attack.privilege_escalation',
                           'cve.2018-2894'],
                  'title': 'Oracle WebLogic Exploit'}},
 {'data_source': {'author': 'Lionel PRAT, Christophe BROCAS, @atc_project '
                            '(improvements)',
                  'description': 'Detect suspicious error on protocol RDP, '
                                 'potential CVE-2019-0708',
                  'detection': {'condition': 'selection',
                                'selection': {'EventID': [56, 50],
                                              'Source': 'TermDD'}},
                  'falsepositives': ['Bad connections or network '
                                     'interruptions'],
                  'id': 'aaa5b30d-f418-420b-83a0-299cb6024885',
                  'level': 'high',
                  'logsource': {'product': 'windows', 'service': 'system'},
                  'references': ['https://github.com/zerosum0x0/CVE-2019-0708',
                                 'https://github.com/Ekultek/BlueKeep'],
                  'status': 'experimental',
                  'tags': ['attack.initial_access',
                           'attack.lateral_movement',
                           'attack.t1210',
                           'attack.t1190',
                           'car.2013-07-002'],
                  'title': 'Potential RDP exploit CVE-2019-0708'}},
 {'data_source': ['Application logs']},
 {'data_source': ['Packet capture']},
 {'data_source': ['Web logs']},
 {'data_source': ['Web application firewall logs']},
 {'data_source': ['Application logs']},
 {'data_source': ['Packet capture']},
 {'data_source': ['Web logs']},
 {'data_source': ['Web application firewall logs']}]
```

## Potential Queries

```json
[{'name': 'Yml',
  'product': 'https://raw.githubusercontent.com/12306Bro/Threathunting-book/master/{}',
  'query': 'Yml\n'
           'title: CVE-2020-0688 Exchange Exploitation via Web Log\n'
           'id: fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5\n'
           'status: experimental\n'
           'description: Detects the exploitation of Microsoft Exchange '
           'vulnerability as described in CVE-2020-0688\n'
           'references:\n'
           '\xa0\xa0\xa0\xa0- '
           'https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\n'
           'author: Florian Roth\n'
           'date: 2020/02/29\n'
           'logsource:\n'
           '\xa0\xa0\xa0\xa0category: webserver\n'
           'detection:\n'
           '\xa0\xa0\xa0\xa0selection1:\n'
           "\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0cs-method: 'GET'\n"
           '\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0c-uri | contains:\n'
           "\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0- '/ ecp /'\n"
           "\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0- '/ owa /'\n"
           '\xa0\xa0\xa0\xa0selection2:\n'
           "\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0c-uri | contains: '__VIEWSTATE ='\n"
           '\xa0\xa0\xa0\xa0condition: selection1 and selection2\n'
           'fields:\n'
           '\xa0\xa0\xa0\xa0- c-ip\n'
           '\xa0\xa0\xa0\xa0- c-dns\n'
           'falsepositives:\n'
           '\xa0\xa0\xa0\xa0- Unknown\n'
           'tags:\n'
           '\xa0\xa0\xa0\xa0- attack.initial_access\n'
           '\xa0\xa0\xa0\xa0- attack.t1190\n'
           'level: critical'},
 {'name': 'Yml',
  'product': 'https://raw.githubusercontent.com/12306Bro/Threathunting-book/master/{}',
  'query': 'Yml\n'
           'title: CVE-2020-0688 Exploitation via Eventlog\n'
           'id: d6266bf5-935e-4661-b477-78772735a7cb\n'
           'status: experimental\n'
           'description: Detects the exploitation of Microsoft Exchange '
           'vulnerability as described in CVE-2020-0688\n'
           'references:\n'
           '\xa0\xa0\xa0\xa0- '
           'https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\n'
           'author: Florian Roth\n'
           'date: 2020/02/29\n'
           'tags:\n'
           '\xa0\xa0\xa0\xa0- attack.initial_access\n'
           '\xa0\xa0\xa0\xa0- attack.t1190\n'
           'logsource:\n'
           '\xa0\xa0\xa0\xa0product: windows\n'
           '\xa0\xa0\xa0\xa0service: application\n'
           'detection:\n'
           '\xa0\xa0\xa0\xa0selection1:\n'
           '\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0EventID: 4\n'
           '\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Source: MSExchange Control Panel\n'
           '\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Level: Error\n'
           '\xa0\xa0\xa0\xa0selection2:\n'
           "\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0- '* & __ VIEWSTATE = *'\n"
           '\xa0\xa0\xa0\xa0condition: selection1 and selection2\n'
           'falsepositives:\n'
           '\xa0\xa0\xa0\xa0- Unknown\n'
           'level: high'},
 {'name': 'Yml',
  'product': 'https://raw.githubusercontent.com/12306Bro/Threathunting-book/master/{}',
  'query': 'Yml\n'
           'title: CVE-2020-0688 Exploitation IIS Eventlog\n'
           'id: d6266bf5-935e-4661-b477-78772735a7cb\n'
           'status: experimental\n'
           'description: Detects the exploitation of Microsoft Exchange '
           'vulnerability as described in CVE-2020-0688\n'
           'references:\n'
           '\xa0\xa0\xa0\xa0- '
           'https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\n'
           'author: Florian Roth\n'
           'date: 2020/02/29\n'
           'tags:\n'
           '\xa0\xa0\xa0\xa0- attack.initial_access\n'
           '\xa0\xa0\xa0\xa0- attack.t1190\n'
           'logsource:\n'
           '\xa0\xa0\xa0\xa0product: windows\n'
           '\xa0\xa0\xa0\xa0service: IIS\n'
           'detection:\n'
           '\xa0\xa0\xa0\xa0selection1:\n'
           "\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0cs-method: 'POST'\n"
           "\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0c-uri | contains: '/owa/auth.owa'\n"
           '\xa0\xa0\xa0\xa0selection2:\n'
           "\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0cs-method: 'GET'\n"
           '\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0c-uri | contains: '
           "'__VIEWSTATEGENERATOR = * __VIEWSTATE ='\n"
           '\xa0\xa0\xa0\xa0timeframe: 3s # can be adjusted according to '
           'actual situation\n'
           '\xa0\xa0\xa0\xa0condition: selection1 and selection2\n'
           'falsepositives:\n'
           '\xa0\xa0\xa0\xa0- Unknown\n'
           'level: high'}]
```

## Raw Dataset

```json
[{'Empire Module XLSX Sheet by dstepanic': {'ATT&CK Technique #1': 'T1190',
                                            'ATT&CK Technique #2': '',
                                            'Concatenate for Python Dictionary': '"powershell/lateral_movement/jenkins_script_console":  '
                                                                                 '["T1190"],',
                                            'Empire Module': 'powershell/lateral_movement/jenkins_script_console',
                                            'Technique': 'Exploit '
                                                         'Public-Facing '
                                                         'Application'}},
 {'Empire Module XLSX Sheet by dstepanic': {'ATT&CK Technique #1': 'T1190',
                                            'ATT&CK Technique #2': '',
                                            'Concatenate for Python Dictionary': '"python/exploit/web/jboss_jmx":  '
                                                                                 '["T1190"],',
                                            'Empire Module': 'python/exploit/web/jboss_jmx',
                                            'Technique': 'Exploit '
                                                         'Public-Facing '
                                                         'Application'}}]
```

# Tactics


* [Initial Access](../tactics/Initial-Access.md)


# Mitigations

None

# Actors


* [Night Dragon](../actors/Night-Dragon.md)

* [Axiom](../actors/Axiom.md)
    
* [Soft Cell](../actors/Soft-Cell.md)
    
